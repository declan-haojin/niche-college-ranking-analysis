---
title: "College Ranking Predictions"
subtitle: "Report"
format: html
editor: visual
execute:
  echo: false
message: false
warning: false
editor_options: 
  chunk_output_type: inline
---

```{r}
#| label: load-pkgs
#| message: false

library(tidyverse)
library(corrplot)
library(tidymodels)
library(scales)
library(ggthemes)
```

# Introduction

## Research Background

Every year, millions of students apply to colleges across the United States, and many of them use college rankings lists from sources such as *US News and World Report*, Forbes.com, and Niche.com to to help them decide where to apply and where to go. In recent years, these lists have been heavily criticized for focusing on "exclusivity and resources, rather than accessibility and economic mobility" (1).The system can also be easily manipulated by a university if that university prioritize certain metrics to raise their rankings, as seen in Northeastern University meteoric rise from #163 to #49 on the US News and World Report list in only 17 years. The president of Northeastern University even explicitly stated that it was a top priority of the university to raise its ranking (2).

\(1\) https://thehill.com/changing-america/enrichment/education/3641004-the-scandal-facing-college-ranking-lists-explained/

\(2\) https://www.bostonmagazine.com/news/2014/08/26/how-northeastern-gamed-the-college-rankings/

These lists are important because students applying to college trust these rankings and weigh them into their college decisions. Due to the large impact that a college has on a student's life, it is important to know where these rankings come from and what they actually measure. In this project, we will explore how influential different metrics are in determining a college's ranking.

In general, we want to examine how different variables affect a school's ranking on the **Niche College Ranking List** and determine which are most important to a high ranking. We plan to look at variables that are typically thought to influence school rank such as average SAT score and admission rate, but we also want to look at variables that aren't typically thought of such as geographic region or endowment size.

For the sake of clarity, when we say a "low rank," we are referring to schools with a lower numerical rank, such as #1 and #2. When we say a "high rank," we a referring to schools with a high numerical rank, such as #499 and #500.

## Data

```{r}
#| label: import

niche_data_500 <- read_csv("data/niche_data_500.csv")
us_dep_of_ed <- read_csv("data/us_dep_of_ed.csv", na = c("NULL", "PrivacySuppressed"))
```

### Data Set #1: Niche

-   The first data set comes from Niche's "2023 Best Colleges in America" list

    (https://www.niche.com/colleges/search/best-colleges/)

-   Niche aggregates data from a variety of sources, including the US Department of Education and reviews from students and alumni, to build their list of college rankings. The rankings list is updated monthly to reflect new data that Niche receives. However, Niche only receives data from the US Department of Education on an annual basis. The Niche data was scraped by Maia on October 17-19 2022.

-   There are `r nrow(niche_data_500)` observations, representing the top 500 schools in the United States. Each observation has two variables: `college` and `rank`.

### Data Set #2: US Department of Education

-   The second data set comes from the US Department of Education's College Scorecard, which is an exhaustive summary of characteristics and statistics for all colleges and universities in the United States.

    (https://collegescorecard.ed.gov/data/)

-   The College Scorecard is updated by the Education Department as it collects new data. Data used in the scorecard comes comes from data reported by the institutions, data on federal financial aid, data from taxes, and data from other federal agencies.

-   There were 2,989 variables in the original data set, many of which we don't need to answer our question, and since this data set was too large to load into RStudio, we used Excel to narrow this to 31 variables. We chose any variables that we thought would have an impact on college rank, and excluded redundant ones like specific breaksdowns of test scores. There are `r nrow(us_dep_of_ed)` observations in the data set, representing all of the colleges and universities in the United States.

### Variable Summary

Here is a summary of the variables we will be using in our analysis.

Categorical:

-   `college`: Institution name

+---------------+------------------+------------------------------------------------------------------------------------------------------------------------------------+
| Variable Name | Categorical (C)  | Description                                                                                                                        |
|               |                  |                                                                                                                                    |
|               | Quantitative (Q) |                                                                                                                                    |
+===============+==================+====================================================================================================================================+
| college       | C                | Institution name                                                                                                                   |
+---------------+------------------+------------------------------------------------------------------------------------------------------------------------------------+
| rank          | Q                | Niche rank                                                                                                                         |
+---------------+------------------+------------------------------------------------------------------------------------------------------------------------------------+
| REGION        | C                | US geographic region (New England, Mid East, Great Lakes, Plains, Southeast, Southwest, Rocky Mountains, Far West, Outlying Areas) |
+---------------+------------------+------------------------------------------------------------------------------------------------------------------------------------+
| ACCREDAGENCY  | C                | Accreditor for Institution                                                                                                         |
+---------------+------------------+------------------------------------------------------------------------------------------------------------------------------------+
| CONTROL       | C                | Public, Private nonprofit, or Private for-profit                                                                                   |
+---------------+------------------+------------------------------------------------------------------------------------------------------------------------------------+
| CCBASIC       | C                | Carnegie Classification (basic)                                                                                                    |
+---------------+------------------+------------------------------------------------------------------------------------------------------------------------------------+
| ADM_RATE      | Q                | Admission rate                                                                                                                     |
+---------------+------------------+------------------------------------------------------------------------------------------------------------------------------------+
| UGDS          | Q                | Enrollment of undergraduate certificate/degree-seeking students                                                                    |
+---------------+------------------+------------------------------------------------------------------------------------------------------------------------------------+
| UGDS_WHITE    | Q                | Total share of enrollment of undergraduate degree-seeking students who are white                                                   |
+---------------+------------------+------------------------------------------------------------------------------------------------------------------------------------+
| UGDS_BLACK    | Q                | Total share of enrollment of undergraduate degree-seeking students who are black                                                   |
+---------------+------------------+------------------------------------------------------------------------------------------------------------------------------------+
| UGDS_HISP     | Q                | Total share of enrollment of undergraduate degree-seeking students who are Hispanic                                                |
+---------------+------------------+------------------------------------------------------------------------------------------------------------------------------------+
| UGDS_ASIAN    | Q                | Total share of enrollment of undergraduate degree-seeking students who are Asian                                                   |
+---------------+------------------+------------------------------------------------------------------------------------------------------------------------------------+
| UGDS_AIAN     | Q                | Total share of enrollment of undergraduate degree-seeking students who are American Indian/Alaska Native                           |
+---------------+------------------+------------------------------------------------------------------------------------------------------------------------------------+
| UGDS_NHPI     | Q                | Total share of enrollment of undergraduate degree-seeking students who are Native Hawaiian/Pacific Islander                        |
+---------------+------------------+------------------------------------------------------------------------------------------------------------------------------------+
| UGDS_2MOR     | Q                | Total share of enrollment of undergraduate degree-seeking students who are two or more races                                       |
+---------------+------------------+------------------------------------------------------------------------------------------------------------------------------------+
| UGDS_NRA      | Q                | Total share of enrollment of undergraduate degree-seeking students who are non-resident aliens                                     |
+---------------+------------------+------------------------------------------------------------------------------------------------------------------------------------+
| UGDS_UNKN     | Q                | Total share of enrollment of undergraduate degree-seeking students whose race is unknown                                           |
+---------------+------------------+------------------------------------------------------------------------------------------------------------------------------------+
| NPT4_PUB      | Q                | Average net price for Title IV institutions (public institutions)                                                                  |
+---------------+------------------+------------------------------------------------------------------------------------------------------------------------------------+
| NPT4_PRIV     | Q                | Average net price for Title IV institutions (private for-profit and nonprofit institutions)                                        |
+---------------+------------------+------------------------------------------------------------------------------------------------------------------------------------+
| COSTT4_A      | Q                | Average cost of attendance (academic year institutions)                                                                            |
+---------------+------------------+------------------------------------------------------------------------------------------------------------------------------------+
| COSTT4_P      | Q                | Average cost of attendance (program-year institutions)                                                                             |
+---------------+------------------+------------------------------------------------------------------------------------------------------------------------------------+
| AVGFACSAL     | Q                | Average faculty salary                                                                                                             |
+---------------+------------------+------------------------------------------------------------------------------------------------------------------------------------+
| PCTPELL       | Q                | Percentage of undergraduates who receive a Pell Grant                                                                              |
+---------------+------------------+------------------------------------------------------------------------------------------------------------------------------------+
| C150_4        | Q                | Completion rate for first-time, full-time students at four-year institutions (150% of expected time to completion)                 |
+---------------+------------------+------------------------------------------------------------------------------------------------------------------------------------+
| AGE_ENTRY     | Q                | Average age of entry                                                                                                               |
+---------------+------------------+------------------------------------------------------------------------------------------------------------------------------------+
| FEMALE        | Q                | Share of female students                                                                                                           |
+---------------+------------------+------------------------------------------------------------------------------------------------------------------------------------+
| MARRIED       | Q                | Share of married students                                                                                                          |
+---------------+------------------+------------------------------------------------------------------------------------------------------------------------------------+
| FIRST_GEN     | Q                | Share of first-generation students                                                                                                 |
+---------------+------------------+------------------------------------------------------------------------------------------------------------------------------------+
| FAMINC        | Q                | Average family income                                                                                                              |
+---------------+------------------+------------------------------------------------------------------------------------------------------------------------------------+
| MD_FAMINC     | Q                | Median family income                                                                                                               |
+---------------+------------------+------------------------------------------------------------------------------------------------------------------------------------+
| ENDOWBEGIN    | Q                | Value of school's endowment at the beginning of the fiscal year                                                                    |
+---------------+------------------+------------------------------------------------------------------------------------------------------------------------------------+
| SAT_AVG       | Q                | Average SAT equivalent score of students admitted                                                                                  |
+---------------+------------------+------------------------------------------------------------------------------------------------------------------------------------+
| ACTCMMID      | Q                | Midpoint of the ACT cumulative score                                                                                               |
+---------------+------------------+------------------------------------------------------------------------------------------------------------------------------------+

### Data Preparation

1.  To get the data, we scraped from Niche.com and downloaded data from the US Department of Education, and imported. The steps were done in an R script titled `niche-scrape.R`
2.  Some of the college names were slightly different between datasets, so we had to individually change names in the Department of Education dataset to match those in the Niche one before joining the two. The Observations for `University of South Florida - Sarasota-Manatee` (ranked 141) and `University of South Florida - St. Petersburg` (ranked 181) have been dropped from the `colleges` data set due to their non-existence in the `us_dep_of_ed` data set. They were not present in the data set because these two universities were combined with the main University of South Florida campus. This is why the `colleges` data set only has 498 observations.

```{r}
#| label: fix-college-names

us_dep_of_ed <- us_dep_of_ed |>
  mutate(
    INSTNM = case_when(
      INSTNM == "Columbia University in the City of New York" ~
        "Columbia University",

      INSTNM == "Washington University in St Louis" ~
        "Washington University in St. Louis",

      INSTNM == "University of California-Los Angeles" ~
        "University of California - Los Angeles",

      INSTNM == "University of Michigan-Ann Arbor" ~
        "University of Michigan - Ann Arbor",

      INSTNM == "Georgia Institute of Technology-Main Campus" ~
        "Georgia Institute of Technology",

      INSTNM == "University of Virginia-Main Campus" ~
        "University of Virginia",

      INSTNM == "United States Military Academy" ~
        "United States Military Academy at West Point",

      INSTNM == "The University of Texas at Austin" ~
        "University of Texas - Austin",

      INSTNM == "University of California-Berkeley" ~
        "University of California - Berkeley",

      INSTNM == "University of California-Irvine" ~
        "University of California - Irvine",

      INSTNM == "University of California-San Diego" ~
        "University of California - San Diego",

      INSTNM == "University of California-Davis" ~
        "University of California - Davis",

      INSTNM == "University of California-Santa Barbara" ~
        "University of California - Santa Barbara",

      INSTNM == "University of California-Santa Cruz" ~
        "University of California - Santa Cruz",

      INSTNM == "University of California-Riverside" ~
        "University of California - Riverside",

      INSTNM == "University of North Carolina Wilmington" ~
        "University of North Carolina - Wilmington",

      INSTNM == "University of North Carolina at Greensboro" ~
        "University of North Carolina - Greensboro",

      INSTNM == "Albany College of Pharmacy and Health Sciences" ~
        "Albany College of Pharmacy & Health Sciences",

      INSTNM == "Arizona State University Campus Immersion" ~
        "Arizona State University",

      INSTNM == "Arizona State University-Downtown Phoenix" ~
        "Arizona State University - Downtown Phoenix Campus",

      INSTNM == "Augustana College" ~
        "Augustana College - Illinois",

      UNITID == "173160" ~
        "Bethel University - Minnesota",

      INSTNM == "Binghamton University" ~
        "Binghamton University, SUNY",

      INSTNM == "Bowling Green State University-Main Campus" ~
        "Bowling Green State University",

      INSTNM == "California Polytechnic State University-San Luis Obispo" ~
        "California Polytechnic State University (Cal Poly) - San Luis Obispo",

      INSTNM == "California State University-Fullerton" ~
        "California State University - Fullerton",

      INSTNM == "California State University-Long Beach" ~
        "California State University - Long Beach",

      INSTNM == "The College of Wooster" ~
        "College of Wooster",

      INSTNM == "Colorado State University-Fort Collins" ~
        "Colorado State University",

      INSTNM == "Concordia University-Wisconsin" ~
        "Concordia University - Wisconsin",

      INSTNM == "CUNY Bernard M Baruch College" ~
        "CUNY Baruch College",

      INSTNM == "CUNY City College" ~
        "CUNY City College of New York",

      INSTNM == "D'Youville College" ~
        "D'Youville",

      INSTNM == "Eastern New Mexico University-Main Campus" ~
        "Eastern New Mexico University",

      INSTNM == "Embry-Riddle Aeronautical University-Daytona Beach" ~
        "Embry-Riddle Aeronautical University - Daytona Beach",

      INSTNM == "Embry-Riddle Aeronautical University-Worldwide" ~
        "Embry-Riddle Aeronautical University - Worldwide",

      INSTNM == "Florida Agricultural and Mechanical University" ~
        "Florida A&M University",

      INSTNM == "Franklin and Marshall College" ~
        "Franklin & Marshall College",

      INSTNM == "Hobart William Smith Colleges" ~
        "Hobart and William Smith Colleges",

      INSTNM == "Indiana University-Bloomington" ~
        "Indiana University - Bloomington",

      INSTNM == "Indiana University-East" ~
        "Indiana University - East",

      INSTNM == "Indiana University-Purdue University-Indianapolis" ~
        "Indiana University-Purdue University - Indianapolis (IUPUI)",

      INSTNM == "Indiana Wesleyan University-Marion" ~
        "Indiana Wesleyan University",

      INSTNM == "Keiser University-Ft Lauderdale" ~
        "Keiser University - Fort Lauderdale",

      INSTNM == "Kent State University at Kent" ~
        "Kent State University",

      INSTNM == "Louisiana State University and Agricultural & Mechanical College" ~
        "Louisiana State University",

      UNITID == "151786" ~
        "Marian University Indianapolis",

      INSTNM == "Maryville University of Saint Louis" ~
        "Maryville University",

      INSTNM == "Metropolitan State University" ~
        "Metropolitan State University - Minnesota",

      INSTNM == "Miami University-Oxford" ~
        "Miami University",

      INSTNM == "Minnesota State University-Mankato" ~
        "Minnesota State University, Mankato",

      INSTNM == "Molloy College" ~
        "Molloy University",

      INSTNM == "Monroe College" ~
        "Monroe College - Bronx/New Rochelle",

      INSTNM == "Mount Saint Mary's University" ~
        "Mount Saint Mary's University Los Angeles",

      INSTNM == "New Mexico State University-Main Campus" ~
        "New Mexico State University",

      INSTNM == "New Mexico Institute of Mining and Technology" ~
        "New Mexico Tech",

      INSTNM == "North Carolina State University at Raleigh" ~
        "North Carolina State University",

      INSTNM == "North Dakota State University-Main Campus" ~
        "North Dakota State University",

      UNITID ==  "154101" ~
        "Northwestern College - Iowa",

      INSTNM == "Ohio University-Main Campus" ~
        "Ohio University",

      INSTNM == "Oklahoma State University-Main Campus" ~
        "Oklahoma State University",

      INSTNM == "Pacific University" ~
        "Pacific University Oregon",

      INSTNM == "The Pennsylvania State University" ~
        "Penn State",

      INSTNM == "Pennsylvania State University-Penn State Fayette- Eberly" ~
        "Penn State Fayette, The Eberly Campus",

      INSTNM == "Pennsylvania State University-Penn State York" ~
        "Penn State York",

      INSTNM == "Purdue University-Main Campus" ~
        "Purdue University",

      INSTNM == "Rutgers University-New Brunswick" ~
        "Rutgers University - New Brunswick",

      INSTNM == "Rutgers University-Newark" ~
        "Rutgers University - Newark",

      INSTNM == "The University of the South" ~
        "Sewanee - The University of the South",

      INSTNM == "South Dakota School of Mines and Technology" ~
        "South Dakota School of Mines & Technology",

      INSTNM == "St Bonaventure University" ~
        "St. Bonaventure University",

      INSTNM == "Saint John Fisher College" ~
        "St. John Fisher University",

      INSTNM == "St. Joseph's University-New York" ~
        "St. Joseph's University - New York",

      INSTNM == "St Lawrence University" ~
        "St. Lawrence University",

      INSTNM == "St Olaf College" ~
        "St. Olaf College",

      INSTNM == "Stanbridge University" ~
        "Stanbridge University - Orange County",

      INSTNM == "Stephen F Austin State University" ~
        "Stephen F. Austin State University",

      INSTNM == "Stony Brook University" ~
        "Stony Brook University, SUNY",

      INSTNM == "SUNY College of Environmental Science and Forestry" ~
        "SUNY College of Environmental Science & Forestry",

      INSTNM == "Farmingdale State College" ~
        "SUNY Farmingdale State College",

      INSTNM == "State University of New York at New Paltz" ~
        "SUNY New Paltz",

      INSTNM == "Texas A & M University-College Station" ~
        "Texas A&M University",

      INSTNM == "American Musical and Dramatic Academy" ~
        "The American Musical and Dramatic Academy (AMDA) - New York",

      INSTNM == "The College of Saint Scholastica" ~
        "The College of St. Scholastica",

      INSTNM == "Cooper Union for the Advancement of Science and Art" ~
        "The Cooper Union for the Advancement of Science and Art",

      INSTNM == "The Master's University and Seminary" ~
        "The Master's University",

      INSTNM == "Ohio State University-Main Campus" ~
        "The Ohio State University",

      INSTNM == "University of Alabama in Huntsville" ~
        "The University of Alabama in Huntsville",

      INSTNM == "University of Baltimore" ~
        "The University of Baltimore",

      INSTNM == "University of Tulsa" ~
        "The University of Tulsa",

      INSTNM == "University of Virginia's College at Wise" ~
        "The University of Virginia's College at Wise",

      INSTNM == "Trinity College" ~
        "Trinity College - Connecticut",

      INSTNM == "Tulane University of Louisiana" ~
        "Tulane University",

      UNITID == "196866" ~
        "Union College - New York",

      INSTNM == "University at Buffalo" ~
        "University at Buffalo, SUNY",

      INSTNM == "University of Alabama at Birmingham" ~
        "University of Alabama - Birmingham",

      INSTNM == "University of Cincinnati-Main Campus" ~
        "University of Cincinnati",

      INSTNM == "University of Colorado Denver/Anschutz Medical Campus" ~
        "University of Colorado Denver",

      INSTNM == "University of Maryland-College Park" ~
        "University of Maryland - College Park",

      INSTNM == "University of Maryland-Baltimore County" ~
        "University of Maryland, Baltimore County",

      INSTNM == "University of Massachusetts-Amherst" ~
        "University of Massachusetts - Amherst",

      INSTNM == "University of Massachusetts-Lowell" ~
        "University of Massachusetts Lowell",

      INSTNM == "University of Michigan-Dearborn" ~
        "University of Michigan - Dearborn",

      INSTNM == "University of Minnesota-Crookston" ~
        "University of Minnesota Crookston",

      INSTNM == "University of Minnesota-Duluth" ~
        "University of Minnesota Duluth",

      INSTNM == "University of Minnesota-Twin Cities" ~
        "University of Minnesota Twin Cities",

      INSTNM == "University of Missouri-Columbia" ~
        "University of Missouri",

      INSTNM == "Embry-Riddle Aeronautical University-Prescott" ~
        "Embry-Riddle Aeronautical University - Prescott",

      INSTNM == "South Dakota State University" ~
        "South Dakota State University",

      INSTNM == "St Catherine University" ~
        "St. Catherine University",

      INSTNM == "University of Missouri-Kansas City" ~
        "University of Missouri - Kansas City",

      INSTNM == "University of Missouri-St Louis" ~
        "University of Missouri - St. Louis",

      INSTNM == "University of Nebraska-Lincoln" ~
        "University of Nebraska - Lincoln",

      INSTNM == "University of Nevada-Reno" ~
        "University of Nevada - Reno",

      INSTNM == "University of New Hampshire-Main Campus" ~
        "University of New Hampshire",

      INSTNM == "University of Oklahoma-Norman Campus" ~
        "University of Oklahoma",

      INSTNM == "University of Pittsburgh-Pittsburgh Campus" ~
        "University of Pittsburgh",

      INSTNM == "University of South Carolina-Columbia" ~
        "University of South Carolina",

      INSTNM == "University of St Francis" ~
        "University of St. Francis - Illinois",

      UNITID == "174914" ~
        "University of St. Thomas - Minnesota",

      UNITID == "227863" ~
        "University of St. Thomas - Texas",

      INSTNM == "The University of Tennessee-Knoxville" ~
        "University of Tennessee",

      INSTNM == "The University of Tennessee-Martin" ~
        "University of Tennessee at Martin",

      INSTNM == "The University of Texas at Arlington" ~
        "University of Texas - Arlington",

      INSTNM == "The University of Texas at Dallas" ~
        "University of Texas - Dallas",

      INSTNM == "The University of Texas Permian Basin" ~
        "University of Texas - Permian Basin",

      INSTNM == "The University of Texas Rio Grande Valley" ~
        "University of Texas - Rio Grande Valley",

      INSTNM == "The University of Texas at Tyler" ~
        "University of Texas - Tyler",

      INSTNM == "University of Washington-Seattle Campus" ~
        "University of Washington",

      INSTNM == "University of Washington-Bothell Campus" ~
        "University of Washington - Bothell",

      INSTNM == "University of Washington-Tacoma Campus" ~
        "University of Washington - Tacoma",

      INSTNM == "The University of West Florida" ~
        "University of West Florida",

      INSTNM == "University of Wisconsin-Madison" ~
        "University of Wisconsin",

      INSTNM == "University of Wisconsin-La Crosse" ~
        "University of Wisconsin - La Crosse",

      INSTNM == "Virginia Polytechnic Institute and State University" ~
        "Virginia Tech",

      INSTNM == "West Texas A & M University" ~
        "West Texas A&M University",

      UNITID == "230807" ~
        "Westminster College - Utah",

      INSTNM == "Wheaton College" ~
        "Wheaton College - Illinois",

      INSTNM == "Wheaton College (Massachusetts)" ~
        "Wheaton College - Massachusetts",

      TRUE ~ INSTNM
    )
  )
```

3.  We joined the US Department of Education dataset to the Niche dataset by the college names.

```{r}
#| label: join-datasets

colleges <- niche_data_500 |>
  left_join(us_dep_of_ed, by = c("college" = "INSTNM")) |>
  filter(rank != 141) |>
  filter(rank != 181)

colleges |>
  slice(1:5) |>
  knitr::kable()
```

4.  Then, we selected the variables that we thought could have an impact on college ranking as a starting point for our analysis. These are listed in our data summary.

```{r}
#| label: select-variables

chosen_variables <- c(
  "college",
  "rank",
  "REGION",
  "ACCREDAGENCY",
  "CONTROL",
  "CCBASIC",
  "ADM_RATE",
  "UGDS",
  "UGDS_WHITE",
  "UGDS_BLACK",
  "UGDS_HISP",
  "UGDS_ASIAN",
  "UGDS_AIAN",
  "UGDS_NHPI",
  "UGDS_2MOR",
  "UGDS_NRA",
  "UGDS_UNKN",
  "NPT4_PUB",
  "NPT4_PRIV",
  "COSTT4_A",
  "COSTT4_P",
  "AVGFACSAL",
  "PCTPELL",
  "C150_4",
  "AGE_ENTRY",
  "FEMALE",
  "MARRIED",
  "FIRST_GEN",
  "FAMINC",
  "MD_FAMINC",
  "ENDOWBEGIN",
  "SAT_AVG",
  "ACTCMMID"
)

data <- colleges |>
  dplyr::select(chosen_variables)
```

5.  Some of the categorical variables in the US Department of Education dataset (`REGION`, `CONTROL`, and `CCBASIC`) used numbers to represent the different levels, so we looked at the data dictionary and replaced each number with the words that it represents.

```{r}
#| label: clean-categorical-variables

data <- data |>
  mutate(
    REGION = as.character(REGION),
    REGION = case_when(
      REGION == 1 ~ "New England",
      REGION == 2 ~ "Mid East",
      REGION == 3 ~ "Great Lakes",
      REGION == 4 ~ "Plains",
      REGION == 5 ~ "Southeast",
      REGION == 6 ~ "Southwest",
      REGION == 7 ~ "Rocky Mountains",
      REGION == 8 ~ "Far West",
      REGION == 9 ~ "Outlying Areas"
    ),
    CONTROL = as.character(CONTROL),
    CONTROL = case_when(
      CONTROL == 1 ~ "Public",
      CONTROL == 2 ~ "Private, Non-profit",
      CONTROL == 3 ~ "Private, For-profit"
    ),
    CCBASIC = as.character(CCBASIC),
    CCBASIC = case_when(
      CCBASIC == -2 ~ "Not applicable",
      CCBASIC == 0 ~ "Not classified",
      CCBASIC == 1 ~ "Associate's Colleges: High Transfer-High Traditional",
      CCBASIC == 2 ~ "Associate's Colleges: High Transfer-Mixed Traditional/Nontraditional",
      CCBASIC == 3 ~ "Associate's Colleges: High Transfer-High Nontraditional",
      CCBASIC == 4 ~ "Associate's Colleges: Mixed Transfer/Career & Technical-High Traditional",
      CCBASIC == 5 ~ "Associate's Colleges: Mixed Transfer/Career & Technical-Mixed Traditional/Nontraditional",
      CCBASIC == 6 ~ "Associate's Colleges: Mixed Transfer/Career & Technical-High Nontraditional",
      CCBASIC == 7 ~ "Associate's Colleges: High Career & Technical-High Traditional",
      CCBASIC == 8 ~ "Associate's Colleges: High Career & Technical-Mixed Traditional/Nontraditional",
      CCBASIC == 9 ~ "Associate's Colleges: High Career & Technical-High Nontraditional",
      CCBASIC == 10 ~ "Special Focus Two-Year: Health Professions",
      CCBASIC == 11 ~ "Special Focus Two-Year: Technical Professions",
      CCBASIC == 12 ~ "Special Focus Two-Year: Arts & Design",
      CCBASIC == 13 ~ "Special Focus Two-Year: Other Fields",
      CCBASIC == 14 ~ "Baccalaureate/Associate's Colleges: Associate's Dominant",
      CCBASIC == 15 ~ "Doctoral Universities: Very High Research Activity",
      CCBASIC == 16 ~ "Doctoral Universities: High Research Activity",
      CCBASIC == 17 ~ "Doctoral/Professional Universities",
      CCBASIC == 18 ~ "Master's Colleges & Universities: Larger Programs",
      CCBASIC == 19 ~ "Master's Colleges & Universities: Medium Programs",
      CCBASIC == 20 ~ "Master's Colleges & Universities: Small Programs",
      CCBASIC == 21 ~ "Baccalaureate Colleges: Arts & Sciences Focus",
      CCBASIC == 22 ~ "Baccalaureate Colleges: Diverse Fields",
      CCBASIC == 23 ~ "Baccalaureate/Associate's Colleges: Mixed Baccalaureate/Associate's",
      CCBASIC == 24 ~ "Special Focus Four-Year: Faith-Related Institutions",
      CCBASIC == 25 ~ "Special Focus Four-Year: Medical Schools & Centers",
      CCBASIC == 26 ~ "Special Focus Four-Year: Other Health Professions Schools",
      CCBASIC == 27 ~ "Special Focus Four-Year: Engineering Schools",
      CCBASIC == 28 ~ "Special Focus Four-Year: Other Technology-Related Schools",
      CCBASIC == 29 ~ "Special Focus Four-Year: Business & Management Schools",
      CCBASIC == 30 ~ "Special Focus Four-Year: Arts, Music & Design Schools",
      CCBASIC == 31 ~ "Special Focus Four-Year: Law Schools",
      CCBASIC == 32 ~ "Special Focus Four-Year: Other Special Focus Institutions",
      CCBASIC == 33 ~ "Tribal Colleges"
    )
  )
```

6.  All of the numerical variables are on different scales---for example, SAT scores can range from 400 to 1600, while admittance rate can only range from 0 to 1---and so we standardized them for easier analysis and comparison. We used the `scale()` functions (found at https://www.statology.org/standardize-data-in-r/) to make the mean value of each numeric variable 0, and the standard deviation 1. The first 5 rows of our standardized dataset are printed below.

```{r}
#| label: scale-numerical-variables

scaled_continuous_numeric_variables <- data |>
  select_if(is.numeric) |>
  dplyr::select(-rank) |>
  scale() |>
  data.frame()

other_variables <- data |>
  dplyr::select(rank | REGION | CONTROL | CCBASIC | !where(is.numeric))

scaled_data <- cbind(other_variables, scaled_continuous_numeric_variables) |>
  relocate(college)

scaled_data |>
  slice(1:5) |>
  knitr::kable()
```

## Exploratory Data Analysis

### Means of Different Variables by Rank Group

```{r}
#| label: exploration-by-rank-group

colleges_levels <- data |> 
  mutate(
    level = case_when(
      rank <= 100 ~ "1 to 100",
      rank > 100 & rank <= 200 ~ "101 to 200",
      rank > 200 & rank <= 300 ~ "201 to 300",
      rank > 300 & rank <= 400 ~ "301 to 400",
      rank > 400 & rank <= 500 ~ "401 to 500",
    ),
    .after = rank
  )

colleges_levels |> 
  group_by(level) |> 
  summarize(
    mean_ADM_Rate = mean(ADM_RATE, na.rm = TRUE),
    mean_SAT_AVG = mean(SAT_AVG, na.rm = TRUE),
    mean_ACTCMMID = mean(ACTCMMID, na.rm = TRUE),
    mean_UGDS_WHITE = mean(UGDS_WHITE, na.rm = TRUE),
    mean_UGDS_ASIAN = mean(UGDS_ASIAN, na.rm = TRUE),
    mean_COSTT4_A = mean(COSTT4_A, na.rm = TRUE)
  ) |> 
  rename(
    "Interval" = level,
    "Mean Admission Rate" = mean_ADM_Rate,
    "Mean SAT Average" = mean_SAT_AVG,
    "Mean ACT Median" =  mean_ACTCMMID,
    "Mean % White Students" = mean_UGDS_WHITE,
    "Mean % Asian Students" = mean_UGDS_ASIAN,
    "Mean Cost of Attendance" = mean_COSTT4_A
  ) |> 
  knitr::kable()
```

After grouping the schools into five groups of 100 by their rank, we see that different metrics vary considerably across the group. As the rank level gets higher, the mean admission rate increases, the mean SAT Average decreases, the mean ACT Median decreases, and the cost of attendance decreases. As far as demographic statistics, 1-100 ranked schools have considerably fewer White students and considerably more Asian students than schools ranked above 100.

### Means of Rank by Categorical Variables

Below, we group the schools by the different categorical variables in our analysis and then take the mean rank for each of those groups.

```{r}
#| label: exploration-control

data |> 
  group_by(CONTROL) |> 
  summarize(
    mean_rank = mean(rank)
  ) |> 
  arrange(mean_rank) |> 
  rename(
    "Control" = CONTROL, 
    "Mean Rank" = mean_rank
  ) |>
  knitr::kable()
```

We observe that private non-profit colleges have a higher mean rank than public colleges or private for-profit colleges.

```{r}
#| label: exploration-region

data |> 
  group_by(REGION) |> 
  summarize(
    mean_rank = mean(rank)
  ) |> 
  arrange(mean_rank) |> 
  rename(
    "Region" = REGION, 
    "Mean Rank" = mean_rank
  ) |>
  knitr::kable()
```

As far as region, schools from New England have the highest mean rank, while schools from the Plains have the lowest mean rank.

```{r}
#| label: exploration-CCBASIC

data |> 
  group_by(CCBASIC) |> 
  summarize(
    mean_rank = mean(rank)
  ) |> 
  arrange(mean_rank) |>
  rename(
    "Carnegie Classification (Basic)" = CCBASIC, 
    "Mean Rank" = mean_rank
  ) |>
  knitr::kable()
```

Looking at the Carnegie Classification, Special Focus Four-Year: Business & Management Schools have the highest mean rank, followed by Doctoral Universities: Very High Research Activity. Tribal Colleges have the lowest mean rank.

```{r}
#| label: exploration-state

colleges |> 
  group_by(STABBR) |> 
  summarize(
    mean_rank = mean(rank)
  ) |> 
  arrange(mean_rank) |> 
  rename(
    "State" = STABBR, 
    "Mean Rank" = mean_rank
  ) |>
  slice_head(n = 10) |> 
  knitr::kable()
```

When looking at states, Maine has the highest mean rank, followed by Massachusetts.

## Research Question and Hypothesis

**Question:** Which characteristics of a university are most associated with rankings on the Niche College Ranking list? Of these characteristics, what is the relationship between high and low rank?

**Hypothesis:** We hypothesize that SAT/ACT scores, acceptance rate, and family income will have the strongest association with rank because since Niche's audience is in large part students applying to college, we believe that they prioritize variables important in the college admissions process. Of these variables, we predict that SAT/ACT score will have strong negative relationship, acceptance rate will have a strong positive relationship, and family income will have a strong negative relationship with rank.

In our project, we will join two data sets: The Niche College Rankings list and the US Department of Education College Scorecard

# Methodology

We have split our analysis into two approaches. The first approach consists of looking at the relationship between individual explanatory variables (both categorical and numeric) and college rank. The second approach consists of building an optimized model between many explanatory variables and college rank.\

## Approach #1: Individual Variable Analysis

### Numerical Variable Analysis

In this section, we will look at the linear relationship between the numerical explanatory variables and college rank.

1.  Create a linear regression model between each individual explanatory variable and college rank.

2.  Calculate the R-squared value for each respective model, rank the values from highest to lowest, and select the variables with the top 6 R-squared values.

3.  Create 6 scatter plots (with lines of best fit) to visualize the relationships between the 6 variables (determined in section 2) and college rank.

4.  Scale each of the 6 explanatory variables to a normal distribution (with mean at 0 and standard deviation of 1). This step is done because the explanatory variables are on varying scales. By scaling the variables to a normal distribution, it allows us to compare their respective slopes.

5.  Recreate the individual models with the scaled explanatory variables, and calculate the respective slopes between each of the scaled explanatory variables and college rank.

6.  Calculate the respective slopes between each of the un-scaled explanatory variables and college rank.

7.  Analyze the relationships between each explanatory variable and college rank by

    1.  Interpreting the R-squared values to determine strength of linear association

    2.  interpreting the graphs to visualize this relationship.

    3.  Using the scaled slopes to determine which explanatory variable has the greatest influence on college on a school having a higher rank.

    4.  Using the un-scaled slopes to interpret the relationships.

### Categorical Variable Analysis

1.  

2.  

3.  

## Approach #2: Stepwise regression modeling

-   Why did we choose this

-   Why did we choose the criterions

-   Methods 

# Results

## Approach 1: Individual Variable Analysis

### Numerical Variable Analysis

**Table of R-squared Values**

The table below gives the R-squared values from the linear regression models between each individual explanatory variable and colleges rank, arranged in descending order.

```{r}
#| label: find-r2

numerical_variables  <- c(
  "ADM_RATE",
  "UGDS",
  "UGDS_WHITE",
  "UGDS_BLACK",
  "UGDS_HISP",
  "UGDS_ASIAN",
  "UGDS_AIAN",
  "UGDS_NHPI",
  "UGDS_2MOR",
  "UGDS_NRA",
  "UGDS_UNKN",
  "NPT4_PUB",
  "NPT4_PRIV",
  "COSTT4_A",
  "COSTT4_P",
  "AVGFACSAL",
  "PCTPELL",
  "C150_4",
  "AGE_ENTRY",
  "FEMALE",
  "MARRIED",
  "FIRST_GEN",
  "FAMINC",
  "MD_FAMINC",
  "ENDOWBEGIN",
  "SAT_AVG",
  "ACTCMMID"
)

r2s <- numeric()

for(var in numerical_variables) {
  temp_df <- data |>
  select(c(rank, var))
  
  model <- linear_reg() |>
    set_engine("lm") |>
    fit(rank ~ ., data = temp_df)
  
  r2 <- glance(model)$r.squared
  
  r2s <- c(r2s, r2)
}

r_squared_values <- tibble(
  variable = numerical_variables, 
  r_squared = r2s
  ) |> 
  filter(variable != "COSTT4_P")

r_squared_values |>
  arrange(desc(r_squared)) |>
  knitr::kable()
```

`COSTT4_P` (Average cost of attendance for program-year institutions) has been removed because there are only two observations.

We will use the variables with the 6 highest R-squared values (indicating the strongest linear relationship) in our further analysis:

-   Average SAT (`SAT_AVG`)

-   Median ACT(`ACTCMMID`),

-   Graduation Rate (`C150_4`)

-   Average Faculty Salary (`AVGFACSAL`),

-   Admission Rate (`ADM_RATE`)

-   \% Students with Pell Grants (`PCTPELL`)

**How do these 6 metrics influence Niche college rank?**

```{r}

#| label: numerical-graphs

library(gridExtra)


a1 <- colleges |> 
  ggplot(aes(x = SAT_AVG, y = rank)) +
  geom_point(alpha = 0.25) +
  geom_smooth(method = "lm") +
  labs(
    x = "Avg. SAT",
    y = "Rank"
  ) 

a2 <- colleges |> 
  ggplot(aes(x = ACTCMMID, y = rank)) +
  geom_point(alpha = 0.25) +
  geom_smooth(method = "lm") +
  labs(
    x = "Med. ACT",
    y = "Rank"
  )

a3 <- colleges |> 
  ggplot(aes(x = C150_4, y = rank)) +
  geom_point(alpha = 0.25) +
  geom_smooth(method = "lm") +
  labs(
    x = "Graduation Rate",
    y = "Rank"
  )

a4 <- colleges |> 
  ggplot(aes(x = AVGFACSAL, y = rank)) +
  geom_point(alpha = 0.25) +
  geom_smooth(method = "lm") +
  labs(
    x = "Avg. Faculty Salary",
    y = "Rank"
  )

a5 <- colleges |> 
  ggplot(aes(x = ADM_RATE, y = rank)) +
  geom_point(alpha = 0.25) +
  geom_smooth(method = "lm") +
  labs(
    x = "Admission Rate",
    y = "Rank"
  )

a6 <- colleges |> 
  ggplot(aes(x = PCTPELL, y = rank)) +
  geom_point(alpha = 0.25) +
  geom_smooth(method = "lm") +
  labs(
    x = "% Students with Pell Grants",
    y = "Rank"
  )

grid.arrange(a1, a2, a3, a4, a5, a6, ncol = 2)
```

```{r}
#| output: false

#| label: numerical-slope-r2

linear_reg() |> fit(rank ~ SAT_AVG, data = scaled_data)
linear_reg() |> fit(rank ~ SAT_AVG, data = colleges)

linear_reg() |> fit(rank ~ ACTCMMID, data = scaled_data)
linear_reg() |> fit(rank ~ ACTCMMID, data = colleges)

linear_reg() |> fit(rank ~ C150_4, data = scaled_data)
linear_reg() |> fit(rank ~ C150_4, data = colleges)

linear_reg() |> fit(rank ~ AVGFACSAL, data = scaled_data)
linear_reg() |> fit(rank ~ AVGFACSAL, data = colleges)

linear_reg() |> fit(rank ~ ADM_RATE, data = scaled_data)
linear_reg() |> fit(rank ~ ADM_RATE, data = colleges)

linear_reg() |> fit(rank ~ PCTPELL, data = scaled_data)
linear_reg() |> fit(rank ~ PCTPELL, data = colleges)
```

**R-squared, scaled slope, and un-scaled slope for linear regression models between 6 metrics and Niche College Rank**

```{r}

#| label: r2-slopes-kable

r2_slopes <- r_squared_values |>
  arrange(desc(r_squared)) |> 
  slice_head(n = 6) |> 
  mutate(
    scaled_slope = c(-115.0, -112.9, -103.5, -98.89, 91.74, 71.75),
    slope = c(-0.9277, -30.04, -735.2, -0.0347, 387.02, 644.76)         )

r2_slopes |> knitr::kable()
```

**Analysis**

Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Gravida dictum fusce ut placerat orci nulla pellentesque dignissim enim. Nisi vitae suscipit tellus mauris a diam. Egestas tellus rutrum tellus pellentesque eu tincidunt. Tristique senectus et netus et. Id neque aliquam vestibulum morbi blandit cursus. Praesent semper feugiat nibh sed pulvinar. Lobortis scelerisque fermentum dui faucibus in ornare quam viverra. Orci eu lobortis elementum nibh tellus molestie. At erat pellentesque adipiscing commodo elit at imperdiet. Risus sed vulputate odio ut enim. Pellentesque habitant morbi tristique senectus et. Vitae tempus quam pellentesque nec. Ut sem viverra aliquet eget sit.

Pellentesque habitant morbi tristique senectus et netus et. Cursus risus at ultrices mi. Tempor orci eu lobortis elementum nibh tellus molestie nunc non. Mauris a diam maecenas sed enim ut sem viverra. Magna sit amet purus gravida quis blandit turpis cursus in. Facilisis magna etiam tempor orci eu lobortis. Semper auctor neque vitae tempus quam pellentesque nec nam. Tempus urna et pharetra pharetra massa massa ultricies. In nibh mauris cursus mattis molestie a. Non nisi est sit amet facilisis magna etiam tempor. Tristique risus nec feugiat in fermentum posuere urna nec. Pharetra diam sit amet nisl suscipit. Viverra adipiscing at in tellus.

### Categorical Variable Analysis

```{r}
#| label: rank-vs-region
#| layout-ncol: 2
#| #| layout-ncol: 2

colleges_levels |>
  ggplot(aes(y = REGION, fill = fct_rev(level))) +
  geom_bar(position = "fill") +
  scale_fill_viridis_d(limits = c("1 to 100", "101 to 200", "201 to 300", "301 to 400", "401 to 500")) +
  labs(
    title = "Rank vs Geographic Region of the United States",
    x = "Proportion",
    y = "Region",
    fill = "Rank"
  )

colleges_levels |>
  ggplot(aes(y = str_wrap(ACCREDAGENCY, 30), fill = fct_rev(level))) +
  geom_bar(position = "fill") +
  scale_fill_viridis_d(limits = c("1 to 100", "101 to 200", "201 to 300", "301 to 400", "401 to 500")) +
  labs(
    title = "Rank vs Accredation Agency",
    x = "Proportion",
    y = "Accredation Agency",
    fill = "Rank"
  )

colleges_levels |>
  ggplot(aes(y = CONTROL, fill = fct_rev(level))) +
  geom_bar(position = "fill") +
  scale_fill_viridis_d(limits = c("1 to 100", "101 to 200", "201 to 300", "301 to 400", "401 to 500")) +
  labs(
    title = "Rank vs Control",
    x = "Proportion",
    y = "Control",
    fill = "Rank"
  )

colleges_levels |>
  ggplot(aes(y = str_wrap(CCBASIC, 30), fill = fct_rev(level))) +
  geom_bar(position = "fill") +
  scale_fill_viridis_d(limits = c("1 to 100", "101 to 200", "201 to 300", "301 to 400", "401 to 500")) +
  labs(
    title = "Rank vs Carnegie Classification",
    x = "Proportion",
    y = "Carnegie Classification (Basic)",
    fill = "Rank"
  )
```

There appear to be the greatest differences between bars of proportions of rank groups in the Carnegie Classification group, suggesting that this has the strongest association with rank. NOT DONE

## Approach 2: Stepwise Regression Model

Another method we use to answer our research question that which characteristic of a university are most associated with rankings is through stepwise regression model. We choose stepwise regression model because of its ability to manage large amounts of potential predictor variables and fine-tuning the model to choose the best predictor variables from the available options. In our case, we have more than 25 variables to be examined and thus it is crucial to have a automated workflow for model selections.

In our research, we will use both forward and backward selections in the stepwise regression model by utilizing `MASS` package. We will evaluate the performance of each iteration of the model based on AIC since AIC is used to compare different possible models and determine which one is the best fit for the data in statistic practice. 

There are three main steps in this approach. 
- First, we need to find out all the highly corrected variable pairs and remove one of it from each pair since we need to rule out the negative impacts of the singularities of variables.
- Second, we will compute the stepwise regression model using `MASS` package and mainly `stepAIC()` functions for model selections based on AIC. For the initial setting of the linear regression model, we will import all the valid variables into the model to predict the `rank` variable.
- Lastly, we will get the best final model with much fewer variables. Those variables are the most influential factors to the rank of the college.


### 1. Remove variables with high correlations

We checked the correlation coefficients between the variables so we don't use variables that are too similar in our model. For the ones that have a absolute value of r greater than 0.8, we picked only one to put in the model. We removed the columns that has more than 100 NA and used the rest for calculating correlations.

```{r}
#| label: correlation-matrix

    data_for_corr <- scaled_data |>
      select(is.numeric)

    correlations = data_for_corr |>
      select(-c("NPT4_PUB", "NPT4_PRIV", "COSTT4_P")) |>
        na.omit() |>
        cor() 

    correlations |>
        corrplot(method="color")
```

According to the correlation matrix, we need to remove variable pairs that have a high correlation (the absolute value \> 0.8). In order to do so, we filter the following correlation table to only display entries with value greater or equal to 0.8.

```{r}
#| label: display-correlation-pair-to-be-removed

correlations[correlations < 0.8 | correlations == 1] <- ""
```

| Variable Pairs with r \> 0.8 | Correlation Coefficients |
|------------------------------|--------------------------|
| C150_4, SAT_AVG              | 0.8389                   |
| C150_4, ACTCMMID             | 0.8494                   |
| AGE_ENTRY, MARRIED           | 0.9059                   |
| FAMINC, MD_FAMINC            | 0.9538                   |
| SAT_AVG, ACTCMMID            | 0.9756                   |

According to the filtered table, these variable pairs are (MD_FAMINC, FAMINC), (C150_4, SAT_AVG), (C150_4, ACTCMMID) and (ACTCMMID, SAT_AVG). Therefore, we will drop the variables C150_4, MD_FAMINC, ACTCMMID and preserve SAT_AVG and FAMINC to represent all other variables.

### 2. Computing Stepwise Regression

As mentioned above, we will use `MASS` package and `StepAIC()` function to perform the stepwise regression process for model selections.

```{r}
#| label: glimpsed-data
stepwise_data <- scaled_data |>
  dplyr::select(c("college", "rank", "REGION", "CONTROL", "CCBASIC", "ACCREDAGENCY", "ADM_RATE", "UGDS", "UGDS_WHITE", "UGDS_BLACK", "UGDS_HISP", "UGDS_ASIAN", "UGDS_AIAN", "UGDS_NHPI", "UGDS_2MOR", "UGDS_NRA", "UGDS_UNKN", "COSTT4_A", "AVGFACSAL", "PCTPELL", "AGE_ENTRY", "FAMINC", "ENDOWBEGIN", "SAT_AVG", "FEMALE", "FIRST_GEN"))
stepwise_data |>
  names() |>
  knitr::kable(col.names = "Selected Variables")
# Factorize variable
stepwise_data <- stepwise_data |>
  mutate(
    REGION = as.factor(REGION),
    CONTROL = as.factor(CONTROL),
    CCBASIC = as.factor(CCBASIC),
    ACCREDAGENCY = as.factor(ACCREDAGENCY)
    )
library(MASS)
stepwise_data = na.omit(stepwise_data)
# Fit the full model
full_model <- lm(rank ~. -college, data = stepwise_data)
# Stepwise regression model
stepwise_model <- stepAIC(full_model, direction = "both", trace = FALSE)
```


### 3. Final Model Results (TODO for Sam)

```{r}
#| label: model-computing
stepwise_model$anova
```

Add interpretations for the final model results

## Slopes

```{r}
#| label: numerical_slope_r2
#| output: false

linear_reg() |> fit(rank ~ SAT_AVG, data = scaled_data)
linear_reg() |> fit(rank ~ SAT_AVG, data = colleges)

linear_reg() |> fit(rank ~ ACTCMMID, data = scaled_data)
linear_reg() |> fit(rank ~ ACTCMMID, data = colleges)

linear_reg() |> fit(rank ~ C150_4, data = scaled_data)
linear_reg() |> fit(rank ~ C150_4, data = colleges)

linear_reg() |> fit(rank ~ AVGFACSAL, data = scaled_data)
linear_reg() |> fit(rank ~ AVGFACSAL, data = colleges)

linear_reg() |> fit(rank ~ ADM_RATE, data = scaled_data)
linear_reg() |> fit(rank ~ ADM_RATE, data = colleges)

linear_reg() |> fit(rank ~ PCTPELL, data = scaled_data)
linear_reg() |> fit(rank ~ PCTPELL, data = colleges)

linear_reg() |> fit(rank ~ UGDS_NRA, data = scaled_data)
linear_reg() |> fit(rank ~ UGDS_NRA, data = colleges)

linear_reg() |> fit(rank ~ FIRST_GEN, data = scaled_data)
linear_reg() |> fit(rank ~ FIRST_GEN, data = colleges)

linear_reg() |> fit(rank ~ UGDS_ASIAN, data = scaled_data)
linear_reg() |> fit(rank ~ UGDS_ASIAN, data = colleges)

linear_reg() |> fit(rank ~ COSTT4_A, data = scaled_data)
linear_reg() |> fit(rank ~ COSTT4_A, data = colleges)

linear_reg() |> fit(rank ~ FAMINC, data = scaled_data)
linear_reg() |> fit(rank ~ FAMINC, data = colleges)

linear_reg() |> fit(rank ~ AGE_ENTRY, data = scaled_data)
linear_reg() |> fit(rank ~ AGE_ENTRY, data = colleges)

linear_reg() |> fit(rank ~ MARRIED, data = scaled_data)
linear_reg() |> fit(rank ~ MARRIED, data = colleges)


```

# Discussion

## References

Learned how to do for loops from TA Eli Gnesin
